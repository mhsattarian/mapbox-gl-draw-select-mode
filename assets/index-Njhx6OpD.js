import er from"https://unpkg.com/@mapbox/mapbox-gl-draw@1.3.0/src/lib/theme.js";(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))N(P);new MutationObserver(P=>{for(const G of P)if(G.type==="childList")for(const we of G.addedNodes)we.tagName==="LINK"&&we.rel==="modulepreload"&&N(we)}).observe(document,{childList:!0,subtree:!0});function F(P){const G={};return P.integrity&&(G.integrity=P.integrity),P.referrerPolicy&&(G.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?G.credentials="include":P.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function N(P){if(P.ep)return;P.ep=!0;const G=F(P);fetch(P.href,G)}})();var it=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bn={exports:{}};(function(S,w){(function(F,N){S.exports=N()})(it,function(){var F=function(e,t){var n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},o={on:function(r,a,p){if(n[r]===void 0)throw new Error("Invalid event type: "+r);n[r].push({selector:a,fn:p})},render:function(r){t.store.featureChanged(r)}},s=function(r,a){for(var p=n[r],d=p.length;d--;){var g=p[d];if(g.selector(a)){g.fn.call(o,a)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(o),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(r){s("drag",r)},click:function(r){s("click",r)},mousemove:function(r){s("mousemove",r)},mousedown:function(r){s("mousedown",r)},mouseup:function(r){s("mouseup",r)},mouseout:function(r){s("mouseout",r)},keydown:function(r){s("keydown",r)},keyup:function(r){s("keyup",r)},touchstart:function(r){s("touchstart",r)},touchmove:function(r){s("touchmove",r)},touchend:function(r){s("touchend",r)},tap:function(r){s("tap",r)}}},N=6378137;function P(e){var t=0;if(e&&e.length>0){t+=Math.abs(G(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(G(e[n]))}return t}function G(e){var t,n,o,s,r,a,p=0,d=e.length;if(d>2){for(a=0;a<d;a++)a===d-2?(o=d-2,s=d-1,r=0):a===d-1?(o=d-1,s=0,r=1):(o=a,s=a+1,r=a+2),t=e[o],n=e[s],p+=(we(e[r][0])-we(t[0]))*Math.sin(we(n[1]));p=p*N*N/2}return p}function we(e){return e*Math.PI/180}var zn={geometry:function e(t){var n,o=0;switch(t.type){case"Polygon":return P(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)o+=P(t.coordinates[n]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)o+=e(t.geometries[n]);return o}},ring:G},Vn="mapboxgl-ctrl",Jn="mapbox-gl-draw_ctrl-draw-btn",Gn="mapbox-gl-draw_line",Zn="mapbox-gl-draw_polygon",$n="mapbox-gl-draw_point",Yn="mapbox-gl-draw_trash",Wn="mapbox-gl-draw_combine",qn="mapbox-gl-draw_uncombine",Kn="mapboxgl-ctrl-group",Xt="active",Qn="mapbox-gl-draw_boxselect",Be="mapbox-gl-draw-hot",qe="mapbox-gl-draw-cold",Ie="add",Ee="move",Hn="drag",ut="pointer",Ft="none",Q={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Z="Feature",he="Polygon",Re="LineString",H="Point",ge="FeatureCollection",en="Multi",Xn="MultiPoint",eo="MultiLineString",to="MultiPolygon",I={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},Pt="draw.create",no="draw.delete",tn="draw.update",oo="draw.selectionchange",ro="draw.modechange",io="draw.actionable",ao="draw.render",so="draw.combine",uo="draw.uncombine",co="move",lo="change_coordinates",Fe="feature",Lt="midpoint",Ke="vertex",se="true",ye="false",po=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],nn={Point:0,LineString:1,Polygon:2};function fo(e,t){var n=nn[e.geometry.type]-nn[t.geometry.type];return n===0&&e.geometry.type===he?e.area-t.area:n}function te(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(var t=0,n=e.length;t<n;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}te.prototype.add=function(e){return this.has(e)||(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length),this},te.prototype.delete=function(e){return this.has(e)===!1||(this._length--,delete this._items[e],delete this._nums[e]),this},te.prototype.has=function(e){return(typeof e=="string"||typeof e=="number")&&(this._items[e]!==void 0||this._nums[e]!==void 0)},te.prototype.values=function(){var e=this,t=[];return Object.keys(this._items).forEach(function(n){t.push({k:n,v:e._items[n]})}),Object.keys(this._nums).forEach(function(n){t.push({k:JSON.parse(n),v:e._nums[n]})}),t.sort(function(n,o){return n.v-o.v}).map(function(n){return n.k})},te.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ho=[Fe,Lt,Ke],Qe={click:function(e,t,n){return on(e,t,n,n.options.clickBuffer)},touch:function(e,t,n){return on(e,t,n,n.options.touchBuffer)}};function on(e,t,n,o){if(n.map===null)return[];var s=e?function(g,u){return u===void 0&&(u=0),[[g.point.x-u,g.point.y-u],[g.point.x+u,g.point.y+u]]}(e,o):t,r={};n.options.styles&&(r.layers=n.options.styles.map(function(g){return g.id}));var a=n.map.queryRenderedFeatures(s,r).filter(function(g){return ho.indexOf(g.properties.meta)!==-1}),p=new te,d=[];return a.forEach(function(g){var u=g.properties.id;p.has(u)||(p.add(u),d.push(g))}),function(g){return g.map(function(u){return u.geometry.type===he&&(u.area=zn.geometry({type:Z,property:{},geometry:u.geometry})),u}).sort(fo).map(function(u){return delete u.area,u})}(d)}function Ot(e,t){var n=Qe.click(e,null,t),o={mouse:Ft};return n[0]&&(o.mouse=n[0].properties.active===se?Ee:ut,o.feature=n[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(o.mouse=Ie),t.ui.queueMapClasses(o),t.ui.updateMapClasses(),n[0]}function rn(e,t){var n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)}function an(e,t,n){n===void 0&&(n={});var o=n.fineTolerance!=null?n.fineTolerance:4,s=n.grossTolerance!=null?n.grossTolerance:12,r=n.interval!=null?n.interval:500;e.point=e.point||t.point,e.time=e.time||t.time;var a=rn(e.point,t.point);return a<o||a<s&&t.time-e.time<r}function sn(e,t,n){n===void 0&&(n={});var o=n.tolerance!=null?n.tolerance:25,s=n.interval!=null?n.interval:250;return e.point=e.point||t.point,e.time=e.time||t.time,rn(e.point,t.point)<o&&t.time-e.time<s}function Tt(e,t){return e(t={exports:{}},t.exports),t.exports}var kt=Tt(function(e){var t=e.exports=function(n,o){if(o||(o=16),n===void 0&&(n=128),n<=0)return"0";for(var s=Math.log(Math.pow(2,n))/Math.log(o),r=2;s===1/0;r*=2)s=Math.log(Math.pow(2,n/r))/Math.log(o)*r;var a=s-Math.floor(s),p="";for(r=0;r<Math.floor(s);r++)p=Math.floor(Math.random()*o).toString(o)+p;if(a){var d=Math.pow(o,a);p=Math.floor(Math.random()*d).toString(o)+p}var g=parseInt(p,o);return g!==1/0&&g>=Math.pow(2,n)?t(n,o):p};t.rack=function(n,o,s){var r=function(p){var d=0;do{if(d++>10){if(!s)throw new Error("too many ID collisions, use more bits");n+=s}var g=t(n,o)}while(Object.hasOwnProperty.call(a,g));return a[g]=p,g},a=r.hats={};return r.get=function(p){return r.hats[p]},r.set=function(p,d){return r.hats[p]=d,r},r.bits=n||128,r.base=o||16,r}}),$=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||kt(),this.type=t.geometry.type};$.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},$.prototype.incomingCoords=function(e){this.setCoordinates(e)},$.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},$.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},$.prototype.setProperty=function(e,t){this.properties[e]=t},$.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Z,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},$.prototype.internal=function(e){var t={id:this.id,meta:Fe,"meta:type":this.type,active:ye,mode:e};if(this.ctx.options.userProperties)for(var n in this.properties)t["user_"+n]=this.properties[n];return{type:Z,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Pe=function(e,t){$.call(this,e,t)};(Pe.prototype=Object.create($.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Pe.prototype.updateCoordinate=function(e,t,n){this.coordinates=arguments.length===3?[t,n]:[e,t],this.changed()},Pe.prototype.getCoordinate=function(){return this.getCoordinates()};var ue=function(e,t){$.call(this,e,t)};(ue.prototype=Object.create($.prototype)).isValid=function(){return this.coordinates.length>1},ue.prototype.addCoordinate=function(e,t,n){this.changed();var o=parseInt(e,10);this.coordinates.splice(o,0,[t,n])},ue.prototype.getCoordinate=function(e){var t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},ue.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)},ue.prototype.updateCoordinate=function(e,t,n){var o=parseInt(e,10);this.coordinates[o]=[t,n],this.changed()};var X=function(e,t){$.call(this,e,t),this.coordinates=this.coordinates.map(function(n){return n.slice(0,-1)})};(X.prototype=Object.create($.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(e){return e.length>2})},X.prototype.incomingCoords=function(e){this.coordinates=e.map(function(t){return t.slice(0,-1)}),this.changed()},X.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},X.prototype.addCoordinate=function(e,t,n){this.changed();var o=e.split(".").map(function(s){return parseInt(s,10)});this.coordinates[o[0]].splice(o[1],0,[t,n])},X.prototype.removeCoordinate=function(e){this.changed();var t=e.split(".").map(function(o){return parseInt(o,10)}),n=this.coordinates[t[0]];n&&(n.splice(t[1],1),n.length<3&&this.coordinates.splice(t[0],1))},X.prototype.getCoordinate=function(e){var t=e.split(".").map(function(o){return parseInt(o,10)}),n=this.coordinates[t[0]];return JSON.parse(JSON.stringify(n[t[1]]))},X.prototype.getCoordinates=function(){return this.coordinates.map(function(e){return e.concat([e[0]])})},X.prototype.updateCoordinate=function(e,t,n){this.changed();var o=e.split("."),s=parseInt(o[0],10),r=parseInt(o[1],10);this.coordinates[s]===void 0&&(this.coordinates[s]=[]),this.coordinates[s][r]=[t,n]};var go={MultiPoint:Pe,MultiLineString:ue,MultiPolygon:X},ct=function(e,t,n,o,s){var r=n.split("."),a=parseInt(r[0],10),p=r[1]?r.slice(1).join("."):null;return e[a][t](p,o,s)},q=function(e,t){if($.call(this,e,t),delete this.coordinates,this.model=go[t.geometry.type],this.model===void 0)throw new TypeError(t.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(t.geometry.coordinates)};function C(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}(q.prototype=Object.create($.prototype))._coordinatesToFeatures=function(e){var t=this,n=this.model.bind(this);return e.map(function(o){return new n(t.ctx,{id:kt(),type:Z,properties:{},geometry:{coordinates:o,type:t.type.replace("Multi","")}})})},q.prototype.isValid=function(){return this.features.every(function(e){return e.isValid()})},q.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()},q.prototype.getCoordinate=function(e){return ct(this.features,"getCoordinate",e)},q.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(e){return e.type===he?e.getCoordinates():e.coordinates})))},q.prototype.updateCoordinate=function(e,t,n){ct(this.features,"updateCoordinate",e,t,n),this.changed()},q.prototype.addCoordinate=function(e,t,n){ct(this.features,"addCoordinate",e,t,n),this.changed()},q.prototype.removeCoordinate=function(e){ct(this.features,"removeCoordinate",e),this.changed()},q.prototype.getFeatures=function(){return this.features},C.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)},C.prototype.setSelectedCoordinates=function(e){var t=this;this._ctx.store.setSelectedCoordinates(e),e.reduce(function(n,o){return n[o.feature_id]===void 0&&(n[o.feature_id]=!0,t._ctx.store.get(o.feature_id).changed()),n},{})},C.prototype.getSelected=function(){return this._ctx.store.getSelected()},C.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},C.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)},C.prototype.getFeature=function(e){return this._ctx.store.get(e)},C.prototype.select=function(e){return this._ctx.store.select(e)},C.prototype.deselect=function(e){return this._ctx.store.deselect(e)},C.prototype.deleteFeature=function(e,t){return t===void 0&&(t={}),this._ctx.store.delete(e,t)},C.prototype.addFeature=function(e){return this._ctx.store.add(e)},C.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},C.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},C.prototype.setActionableState=function(e){e===void 0&&(e={});var t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)},C.prototype.changeMode=function(e,t,n){return t===void 0&&(t={}),n===void 0&&(n={}),this._ctx.events.changeMode(e,t,n)},C.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)},C.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)},C.prototype.featuresAt=function(e,t,n){if(n===void 0&&(n="click"),n!=="click"&&n!=="touch")throw new Error("invalid buffer type");return Qe[n](e,t,this._ctx)},C.prototype.newFeature=function(e){var t=e.geometry.type;return t===H?new Pe(this._ctx,e):t===Re?new ue(this._ctx,e):t===he?new X(this._ctx,e):new q(this._ctx,e)},C.prototype.isInstanceOf=function(e,t){if(e===H)return t instanceof Pe;if(e===Re)return t instanceof ue;if(e===he)return t instanceof X;if(e==="MultiFeature")return t instanceof q;throw new Error("Unknown feature class: "+e)},C.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)},C.prototype.onSetup=function(){},C.prototype.onDrag=function(){},C.prototype.onClick=function(){},C.prototype.onMouseMove=function(){},C.prototype.onMouseDown=function(){},C.prototype.onMouseUp=function(){},C.prototype.onMouseOut=function(){},C.prototype.onKeyUp=function(){},C.prototype.onKeyDown=function(){},C.prototype.onTouchStart=function(){},C.prototype.onTouchMove=function(){},C.prototype.onTouchEnd=function(){},C.prototype.onTap=function(){},C.prototype.onStop=function(){},C.prototype.onTrash=function(){},C.prototype.onCombineFeature=function(){},C.prototype.onUncombineFeature=function(){},C.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var un={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},yo=Object.keys(un);function mo(e){var t=Object.keys(e);return function(n,o){o===void 0&&(o={});var s={},r=t.reduce(function(a,p){return a[p]=e[p],a},new C(n));return{start:function(){var a=this;s=r.onSetup(o),yo.forEach(function(p){var d,g=un[p],u=function(){return!1};e[g]&&(u=function(){return!0}),a.on(p,u,(d=g,function(f){return r[d](s,f)}))})},stop:function(){r.onStop(s)},trash:function(){r.onTrash(s)},combineFeatures:function(){r.onCombineFeatures(s)},uncombineFeatures:function(){r.onUncombineFeatures(s)},render:function(a,p){r.toDisplayFeatures(s,a,p)}}}}function lt(e){return[].concat(e).filter(function(t){return t!==void 0})}function vo(){var e=this;if(!(e.ctx.map&&e.ctx.map.getSource(Be)!==void 0))return d();var t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});var n=[],o=[];e.isDirty?o=e.getAllIds():(n=e.getChangedIds().filter(function(g){return e.get(g)!==void 0}),o=e.sources.hot.filter(function(g){return g.properties.id&&n.indexOf(g.properties.id)===-1&&e.get(g.properties.id)!==void 0}).map(function(g){return g.properties.id})),e.sources.hot=[];var s=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(function(g){var u=g.properties.id||g.properties.parent;return n.indexOf(u)===-1});var r=s!==e.sources.cold.length||o.length>0;function a(g,u){var f=e.get(g).internal(t);e.ctx.events.currentModeRender(f,function(y){e.sources[u].push(y)})}if(n.forEach(function(g){return a(g,"hot")}),o.forEach(function(g){return a(g,"cold")}),r&&e.ctx.map.getSource(qe).setData({type:ge,features:e.sources.cold}),e.ctx.map.getSource(Be).setData({type:ge,features:e.sources.hot}),e._emitSelectionChange&&(e.ctx.map.fire(oo,{features:e.getSelected().map(function(g){return g.toGeoJSON()}),points:e.getSelectedCoordinates().map(function(g){return{type:Z,properties:{},geometry:{type:H,coordinates:g.coordinates}}})}),e._emitSelectionChange=!1),e._deletedFeaturesToEmit.length){var p=e._deletedFeaturesToEmit.map(function(g){return g.toGeoJSON()});e._deletedFeaturesToEmit=[],e.ctx.map.fire(no,{features:p})}function d(){e.isDirty=!1,e.clearChangedIds()}d(),e.ctx.map.fire(ao,{})}function D(e){var t,n=this;this._features={},this._featureIds=new te,this._selectedFeatureIds=new te,this._selectedCoordinates=[],this._changedFeatureIds=new te,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=function(){t||(t=requestAnimationFrame(function(){t=null,vo.call(n)}))},this.isDirty=!1}function cn(e,t){var n=e._selectedCoordinates.filter(function(o){return e._selectedFeatureIds.has(o.feature_id)});e._selectedCoordinates.length===n.length||t.silent||(e._emitSelectionChange=!0),e._selectedCoordinates=n}D.prototype.createRenderBatch=function(){var e=this,t=this.render,n=0;return this.render=function(){n++},function(){e.render=t,n>0&&e.render()}},D.prototype.setDirty=function(){return this.isDirty=!0,this},D.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this},D.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},D.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},D.prototype.getAllIds=function(){return this._featureIds.values()},D.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this},D.prototype.delete=function(e,t){var n=this;return t===void 0&&(t={}),lt(e).forEach(function(o){n._featureIds.has(o)&&(n._featureIds.delete(o),n._selectedFeatureIds.delete(o),t.silent||n._deletedFeaturesToEmit.indexOf(n._features[o])===-1&&n._deletedFeaturesToEmit.push(n._features[o]),delete n._features[o],n.isDirty=!0)}),cn(this,t),this},D.prototype.get=function(e){return this._features[e]},D.prototype.getAll=function(){var e=this;return Object.keys(this._features).map(function(t){return e._features[t]})},D.prototype.select=function(e,t){var n=this;return t===void 0&&(t={}),lt(e).forEach(function(o){n._selectedFeatureIds.has(o)||(n._selectedFeatureIds.add(o),n._changedFeatureIds.add(o),t.silent||(n._emitSelectionChange=!0))}),this},D.prototype.deselect=function(e,t){var n=this;return t===void 0&&(t={}),lt(e).forEach(function(o){n._selectedFeatureIds.has(o)&&(n._selectedFeatureIds.delete(o),n._changedFeatureIds.add(o),t.silent||(n._emitSelectionChange=!0))}),cn(this,t),this},D.prototype.clearSelected=function(e){return e===void 0&&(e={}),this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this},D.prototype.setSelected=function(e,t){var n=this;return t===void 0&&(t={}),e=lt(e),this.deselect(this._selectedFeatureIds.values().filter(function(o){return e.indexOf(o)===-1}),{silent:t.silent}),this.select(e.filter(function(o){return!n._selectedFeatureIds.has(o)}),{silent:t.silent}),this},D.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this},D.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},D.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},D.prototype.getSelected=function(){var e=this;return this._selectedFeatureIds.values().map(function(t){return e.get(t)})},D.prototype.getSelectedCoordinates=function(){var e=this;return this._selectedCoordinates.map(function(t){return{coordinates:e.get(t.feature_id).getCoordinate(t.coord_path)}})},D.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)},D.prototype.setFeatureProperty=function(e,t,n){this.get(e).setProperty(t,n),this.featureChanged(e)},D.prototype.storeMapConfig=function(){var e=this;po.forEach(function(t){e.ctx.map[t]&&(e._mapInitialConfig[t]=e.ctx.map[t].isEnabled())})},D.prototype.restoreMapConfig=function(){var e=this;Object.keys(this._mapInitialConfig).forEach(function(t){e._mapInitialConfig[t]?e.ctx.map[t].enable():e.ctx.map[t].disable()})},D.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]===void 0||this._mapInitialConfig[e]};var me=function(){for(var e=arguments,t={},n=0;n<arguments.length;n++){var o=e[n];for(var s in o)bo.call(o,s)&&(t[s]=o[s])}return t},bo=Object.prototype.hasOwnProperty,_o=["mode","feature","mouse"];function So(e){var t=null,n=null,o={onRemove:function(){return e.map.off("load",o.connect),clearInterval(n),o.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",o.connect),clearInterval(n),o.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(s){var r=s.fire;return s.fire=function(a,p){var d=arguments;return r.length===1&&arguments.length!==1&&(d=[me({},{type:a},p)]),r.apply(s,d)},e.map=s,e.events=function(a){var p=Object.keys(a.options.modes).reduce(function(l,m){return l[m]=mo(a.options.modes[m]),l},{}),d={},g={},u={},f=null,y=null;u.drag=function(l,m){m({point:l.point,time:new Date().getTime()})?(a.ui.queueMapClasses({mouse:Hn}),y.drag(l)):l.originalEvent.stopPropagation()},u.mousedrag=function(l){u.drag(l,function(m){return!an(d,m)})},u.touchdrag=function(l){u.drag(l,function(m){return!sn(g,m)})},u.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return u.mousedrag(l);var m=Ot(l,a);l.featureTarget=m,y.mousemove(l)},u.mousedown=function(l){d={time:new Date().getTime(),point:l.point};var m=Ot(l,a);l.featureTarget=m,y.mousedown(l)},u.mouseup=function(l){var m=Ot(l,a);l.featureTarget=m,an(d,{point:l.point,time:new Date().getTime()})?y.click(l):y.mouseup(l)},u.mouseout=function(l){y.mouseout(l)},u.touchstart=function(l){if(l.originalEvent.preventDefault(),a.options.touchEnabled){g={time:new Date().getTime(),point:l.point};var m=Qe.touch(l,null,a)[0];l.featureTarget=m,y.touchstart(l)}},u.touchmove=function(l){if(l.originalEvent.preventDefault(),a.options.touchEnabled)return y.touchmove(l),u.touchdrag(l)},u.touchend=function(l){if(l.originalEvent.preventDefault(),a.options.touchEnabled){var m=Qe.touch(l,null,a)[0];l.featureTarget=m,sn(g,{time:new Date().getTime(),point:l.point})?y.tap(l):y.touchend(l)}};var v=function(l){return!(l===8||l===46||l>=48&&l<=57)};function x(l,m,O){O===void 0&&(O={}),y.stop();var L=p[l];if(L===void 0)throw new Error(l+" is not valid");f=l;var A=L(a,m);y=F(A,a),O.silent||a.map.fire(ro,{mode:l}),a.store.setDirty(),a.store.render()}u.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&(l.keyCode!==8&&l.keyCode!==46||!a.options.controls.trash?v(l.keyCode)?y.keydown(l):l.keyCode===49&&a.options.controls.point?x(I.DRAW_POINT):l.keyCode===50&&a.options.controls.line_string?x(I.DRAW_LINE_STRING):l.keyCode===51&&a.options.controls.polygon&&x(I.DRAW_POLYGON):(l.preventDefault(),y.trash()))},u.keyup=function(l){v(l.keyCode)&&y.keyup(l)},u.zoomend=function(){a.store.changeZoom()},u.data=function(l){if(l.dataType==="style"){var m=a.setup,O=a.map,L=a.options,A=a.store;L.styles.some(function(b){return O.getLayer(b.id)})||(m.addLayers(),A.setDirty(),A.render())}};var B={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){f=a.options.defaultMode,y=F(p[f](a),a)},changeMode:x,actionable:function(l){var m=!1;Object.keys(l).forEach(function(O){if(B[O]===void 0)throw new Error("Invalid action type");B[O]!==l[O]&&(m=!0),B[O]=l[O]}),m&&a.map.fire(io,{actions:B})},currentModeName:function(){return f},currentModeRender:function(l,m){return y.render(l,m)},fire:function(l,m){u[l]&&u[l](m)},addEventListeners:function(){a.map.on("mousemove",u.mousemove),a.map.on("mousedown",u.mousedown),a.map.on("mouseup",u.mouseup),a.map.on("data",u.data),a.map.on("touchmove",u.touchmove),a.map.on("touchstart",u.touchstart),a.map.on("touchend",u.touchend),a.container.addEventListener("mouseout",u.mouseout),a.options.keybindings&&(a.container.addEventListener("keydown",u.keydown),a.container.addEventListener("keyup",u.keyup))},removeEventListeners:function(){a.map.off("mousemove",u.mousemove),a.map.off("mousedown",u.mousedown),a.map.off("mouseup",u.mouseup),a.map.off("data",u.data),a.map.off("touchmove",u.touchmove),a.map.off("touchstart",u.touchstart),a.map.off("touchend",u.touchend),a.container.removeEventListener("mouseout",u.mouseout),a.options.keybindings&&(a.container.removeEventListener("keydown",u.keydown),a.container.removeEventListener("keyup",u.keyup))},trash:function(l){y.trash(l)},combineFeatures:function(){y.combineFeatures()},uncombineFeatures:function(){y.uncombineFeatures()},getMode:function(){return f}}}(e),e.ui=function(a){var p={},d=null,g={mode:null,feature:null,mouse:null},u={mode:null,feature:null,mouse:null};function f(l){u=me(u,l)}function y(){var l,m;if(a.container){var O=[],L=[];_o.forEach(function(A){u[A]!==g[A]&&(O.push(A+"-"+g[A]),u[A]!==null&&L.push(A+"-"+u[A]))}),O.length>0&&(l=a.container.classList).remove.apply(l,O),L.length>0&&(m=a.container.classList).add.apply(m,L),g=me(g,u)}}function v(l,m){m===void 0&&(m={});var O=document.createElement("button");return O.className=Jn+" "+m.className,O.setAttribute("title",m.title),m.container.appendChild(O),O.addEventListener("click",function(L){if(L.preventDefault(),L.stopPropagation(),L.target===d)return x(),void m.onDeactivate();B(l),m.onActivate()},!0),O}function x(){d&&(d.classList.remove(Xt),d=null)}function B(l){x();var m=p[l];m&&m&&l!=="trash"&&(m.classList.add(Xt),d=m)}return{setActiveButton:B,queueMapClasses:f,updateMapClasses:y,clearMapClasses:function(){f({mode:null,feature:null,mouse:null}),y()},addButtons:function(){var l=a.options.controls,m=document.createElement("div");return m.className=Kn+" "+Vn,l&&(l[Q.LINE]&&(p[Q.LINE]=v(Q.LINE,{container:m,className:Gn,title:"LineString tool "+(a.options.keybindings?"(l)":""),onActivate:function(){return a.events.changeMode(I.DRAW_LINE_STRING)},onDeactivate:function(){return a.events.trash()}})),l[Q.POLYGON]&&(p[Q.POLYGON]=v(Q.POLYGON,{container:m,className:Zn,title:"Polygon tool "+(a.options.keybindings?"(p)":""),onActivate:function(){return a.events.changeMode(I.DRAW_POLYGON)},onDeactivate:function(){return a.events.trash()}})),l[Q.POINT]&&(p[Q.POINT]=v(Q.POINT,{container:m,className:$n,title:"Marker tool "+(a.options.keybindings?"(m)":""),onActivate:function(){return a.events.changeMode(I.DRAW_POINT)},onDeactivate:function(){return a.events.trash()}})),l.trash&&(p.trash=v("trash",{container:m,className:Yn,title:"Delete",onActivate:function(){a.events.trash()}})),l.combine_features&&(p.combine_features=v("combineFeatures",{container:m,className:Wn,title:"Combine",onActivate:function(){a.events.combineFeatures()}})),l.uncombine_features&&(p.uncombine_features=v("uncombineFeatures",{container:m,className:qn,title:"Uncombine",onActivate:function(){a.events.uncombineFeatures()}}))),m},removeButtons:function(){Object.keys(p).forEach(function(l){var m=p[l];m.parentNode&&m.parentNode.removeChild(m),delete p[l]})}}}(e),e.container=s.getContainer(),e.store=new D(e),t=e.ui.addButtons(),e.options.boxSelect&&(s.boxZoom.disable(),s.dragPan.disable(),s.dragPan.enable()),s.loaded()?o.connect():(s.on("load",o.connect),n=setInterval(function(){s.loaded()&&o.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(qe,{data:{type:ge,features:[]},type:"geojson"}),e.map.addSource(Be,{data:{type:ge,features:[]},type:"geojson"}),e.options.styles.forEach(function(s){e.map.addLayer(s)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(function(s){e.map.getLayer(s.id)&&e.map.removeLayer(s.id)}),e.map.getSource(qe)&&e.map.removeSource(qe),e.map.getSource(Be)&&e.map.removeSource(Be)}};return e.setup=o,o}function Dt(e){return function(t){var n=t.featureTarget;return!!n&&!!n.properties&&n.properties.meta===e}}function ze(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===se&&e.featureTarget.properties.meta===Fe}function ln(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===ye&&e.featureTarget.properties.meta===Fe}function jt(e){return e.featureTarget===void 0}function dt(e){var t=e.featureTarget;return!!t&&!!t.properties&&t.properties.meta===Ke}function At(e){return!!e.originalEvent&&e.originalEvent.shiftKey===!0}function Nt(e){return e.keyCode===27}function Ut(e){return e.keyCode===13}var xo=Ve;function Ve(e,t){this.x=e,this.y=t}function Bt(e,t){var n=t.getBoundingClientRect();return new xo(e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0))}function He(e,t,n,o){return{type:Z,properties:{meta:Ke,parent:e,coord_path:n,active:o?se:ye},geometry:{type:H,coordinates:t}}}function Rt(e,t,n){t===void 0&&(t={}),n===void 0&&(n=null);var o,s=e.geometry,r=s.type,a=s.coordinates,p=e.properties&&e.properties.id,d=[];function g(f,y){var v="",x=null;f.forEach(function(B,l){var m=y!=null?y+"."+l:String(l),O=He(p,B,m,u(m));if(t.midpoints&&x){var L=function(b,Te,be){var E=Te.geometry.coordinates,ne=be.geometry.coordinates;if(E[1]>85||E[1]<-85||ne[1]>85||ne[1]<-85)return null;var K={lng:(E[0]+ne[0])/2,lat:(E[1]+ne[1])/2};return{type:Z,properties:{meta:Lt,parent:b,lng:K.lng,lat:K.lat,coord_path:be.properties.coord_path},geometry:{type:H,coordinates:[K.lng,K.lat]}}}(p,x,O);L&&d.push(L)}x=O;var A=JSON.stringify(B);v!==A&&d.push(O),l===0&&(v=A)})}function u(f){return!!t.selectedPaths&&t.selectedPaths.indexOf(f)!==-1}return r===H?d.push(He(p,a,n,u(n))):r===he?a.forEach(function(f,y){g(f,n!==null?n+"."+y:String(y))}):r===Re?g(a,n):r.indexOf(en)===0&&(o=r.replace(en,""),a.forEach(function(f,y){var v={type:Z,properties:e.properties,geometry:{type:o,coordinates:f}};d=d.concat(Rt(v,t,y))})),d}Ve.prototype={clone:function(){return new Ve(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),o=t*this.x-n*this.y,s=n*this.x+t*this.y;return this.x=o,this.y=s,this},_rotateAround:function(e,t){var n=Math.cos(e),o=Math.sin(e),s=t.x+n*(this.x-t.x)-o*(this.y-t.y),r=t.y+o*(this.x-t.x)+n*(this.y-t.y);return this.x=s,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ve.convert=function(e){return e instanceof Ve?e:Array.isArray(e)?new Ve(e[0],e[1]):e};var Je=function(e){setTimeout(function(){e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},pt=function(e){setTimeout(function(){e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()},0)},dn=function(e){if(!e||!e.type)return null;var t=Co[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e},Co={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function ft(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,n){return t.concat(ft(n))},[]),e;case"Feature":return e.geometry?ft(e.geometry).map(function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(n.id=e.id),n}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(ft).reduce(function(t,n){return t.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}}var Mo=function(e){if(!e)return[];var t=ft(dn(e)),n=[];return t.features.forEach(function(o){o.geometry&&(n=n.concat(function s(r){return Array.isArray(r)&&r.length&&typeof r[0]=="number"?[r]:r.reduce(function(a,p){return Array.isArray(p)&&Array.isArray(p[0])?a.concat(s(p)):(a.push(p),a)},[])}(o.geometry.coordinates)))}),n},wo=Tt(function(e){var t=e.exports=function(u){return new n(u)};function n(u){this.value=u}function o(u,f,y){var v=[],x=[],B=!0;return function l(m){var O=y?s(m):m,L={},A=!0,b={node:O,node_:m,path:[].concat(v),parent:x[x.length-1],parents:x,key:v.slice(-1)[0],isRoot:v.length===0,level:v.length,circular:null,update:function(E,ne){b.isRoot||(b.parent.node[b.key]=E),b.node=E,ne&&(A=!1)},delete:function(E){delete b.parent.node[b.key],E&&(A=!1)},remove:function(E){p(b.parent.node)?b.parent.node.splice(b.key,1):delete b.parent.node[b.key],E&&(A=!1)},keys:null,before:function(E){L.before=E},after:function(E){L.after=E},pre:function(E){L.pre=E},post:function(E){L.post=E},stop:function(){B=!1},block:function(){A=!1}};if(!B)return b;function Te(){if(typeof b.node=="object"&&b.node!==null){b.keys&&b.node_===b.node||(b.keys=r(b.node)),b.isLeaf=b.keys.length==0;for(var E=0;E<x.length;E++)if(x[E].node_===m){b.circular=x[E];break}}else b.isLeaf=!0,b.keys=null;b.notLeaf=!b.isLeaf,b.notRoot=!b.isRoot}Te();var be=f.call(b,b.node);return be!==void 0&&b.update&&b.update(be),L.before&&L.before.call(b,b.node),A&&(typeof b.node!="object"||b.node===null||b.circular||(x.push(b),Te(),d(b.keys,function(E,ne){v.push(E),L.pre&&L.pre.call(b,b.node[E],E);var K=l(b.node[E]);y&&g.call(b.node,E)&&(b.node[E]=K.node),K.isLast=ne==b.keys.length-1,K.isFirst=ne==0,L.post&&L.post.call(b,K),v.pop()}),x.pop()),L.after&&L.after.call(b,b.node)),b}(u).node}function s(u){if(typeof u=="object"&&u!==null){var f;if(p(u))f=[];else if(a(u)==="[object Date]")f=new Date(u.getTime?u.getTime():u);else if(function(x){return a(x)==="[object RegExp]"}(u))f=new RegExp(u);else if(function(x){return a(x)==="[object Error]"}(u))f={message:u.message};else if(function(x){return a(x)==="[object Boolean]"}(u))f=new Boolean(u);else if(function(x){return a(x)==="[object Number]"}(u))f=new Number(u);else if(function(x){return a(x)==="[object String]"}(u))f=new String(u);else if(Object.create&&Object.getPrototypeOf)f=Object.create(Object.getPrototypeOf(u));else if(u.constructor===Object)f={};else{var y=u.constructor&&u.constructor.prototype||u.__proto__||{},v=function(){};v.prototype=y,f=new v}return d(r(u),function(x){f[x]=u[x]}),f}return u}n.prototype.get=function(u){for(var f=this.value,y=0;y<u.length;y++){var v=u[y];if(!f||!g.call(f,v)){f=void 0;break}f=f[v]}return f},n.prototype.has=function(u){for(var f=this.value,y=0;y<u.length;y++){var v=u[y];if(!f||!g.call(f,v))return!1;f=f[v]}return!0},n.prototype.set=function(u,f){for(var y=this.value,v=0;v<u.length-1;v++){var x=u[v];g.call(y,x)||(y[x]={}),y=y[x]}return y[u[v]]=f,f},n.prototype.map=function(u){return o(this.value,u,!0)},n.prototype.forEach=function(u){return this.value=o(this.value,u,!1),this.value},n.prototype.reduce=function(u,f){var y=arguments.length===1,v=y?this.value:f;return this.forEach(function(x){this.isRoot&&y||(v=u.call(this,v,x))}),v},n.prototype.paths=function(){var u=[];return this.forEach(function(f){u.push(this.path)}),u},n.prototype.nodes=function(){var u=[];return this.forEach(function(f){u.push(this.node)}),u},n.prototype.clone=function(){var u=[],f=[];return function y(v){for(var x=0;x<u.length;x++)if(u[x]===v)return f[x];if(typeof v=="object"&&v!==null){var B=s(v);return u.push(v),f.push(B),d(r(v),function(l){B[l]=y(v[l])}),u.pop(),f.pop(),B}return v}(this.value)};var r=Object.keys||function(u){var f=[];for(var y in u)f.push(y);return f};function a(u){return Object.prototype.toString.call(u)}var p=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"},d=function(u,f){if(u.forEach)return u.forEach(f);for(var y=0;y<u.length;y++)f(u[y],y,u)};d(r(n.prototype),function(u){t[u]=function(f){var y=[].slice.call(arguments,1),v=new n(f);return v[u].apply(v,y)}});var g=Object.hasOwnProperty||function(u,f){return f in u}}),Io=Y;function Y(e){if(!(this instanceof Y))return new Y(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}Y.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this},Y.prototype.equals=function(e){var t;return t=e instanceof Y?e.bbox():e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]},Y.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Y.prototype.union=function(e){var t;return this._valid=!0,t=e instanceof Y?e.bbox():e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this},Y.prototype.bbox=function(){return this._valid?this._bbox:null},Y.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n},Y.prototype.intersect=function(e){return this._valid?(t=e instanceof Y?e.bbox():e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])):null;var t},Y.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)},Y.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var pn={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Eo=Object.keys(pn),zt=function(e){return Vt(e).bbox()};function Vt(e){for(var t=Io(),n=Mo(e),o=0;o<n.length;o++)t.include(n[o]);return t}zt.polygon=function(e){return Vt(e).polygon()},zt.bboxify=function(e){return wo(e).map(function(t){t&&Eo.some(function(n){return!!t[n]&&pn[n].indexOf(t.type)!==-1})&&(t.bbox=Vt(t).bbox(),this.update(t))})};function fn(e,t){var n=-90,o=90,s=-90,r=90,a=270,p=-270;e.forEach(function(g){var u=zt(g),f=u[1],y=u[3],v=u[0],x=u[2];f>n&&(n=f),y<o&&(o=y),y>s&&(s=y),f<r&&(r=f),v<a&&(a=v),x>p&&(p=x)});var d=t;return n+d.lat>85&&(d.lat=85-n),s+d.lat>90&&(d.lat=90-s),o+d.lat<-85&&(d.lat=-85-o),r+d.lat<-90&&(d.lat=-90-r),a+d.lng<=-270&&(d.lng+=360*Math.ceil(Math.abs(d.lng)/360)),p+d.lng>=270&&(d.lng-=360*Math.ceil(Math.abs(d.lng)/360)),d}function hn(e,t){var n=fn(e.map(function(o){return o.toGeoJSON()}),t);e.forEach(function(o){var s,r=o.getCoordinates(),a=function(d){var g={lng:d[0]+n.lng,lat:d[1]+n.lat};return[g.lng,g.lat]},p=function(d){return d.map(function(g){return a(g)})};o.type===H?s=a(r):o.type===Re||o.type===Xn?s=r.map(a):o.type===he||o.type===eo?s=r.map(p):o.type===to&&(s=r.map(function(d){return d.map(function(g){return p(g)})})),o.incomingCoords(s)})}var J={onSetup:function(e){var t=this,n={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(n.initiallySelectedFeatureIds.filter(function(o){return t.getFeature(o)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),n},fireUpdate:function(){this.map.fire(tn,{action:co,features:this.getSelected().map(function(e){return e.toGeoJSON()})})},fireActionable:function(){var e=this,t=this.getSelected(),n=t.filter(function(p){return e.isInstanceOf("MultiFeature",p)}),o=!1;if(t.length>1){o=!0;var s=t[0].type.replace("Multi","");t.forEach(function(p){p.type.replace("Multi","")!==s&&(o=!1)})}var r=n.length>0,a=t.length>0;this.setActionableState({combineFeatures:o,uncombineFeatures:r,trash:a})},getUniqueIds:function(e){return e.length?e.map(function(t){return t.properties.id}).filter(function(t){return t!==void 0}).reduce(function(t,n){return t.add(n),t},new te).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){Je(this)},onMouseMove:function(e){return this.stopExtendedInteractions(e),!0},onMouseOut:function(e){return!e.dragMoving||this.fireUpdate()}};J.onTap=J.onClick=function(e,t){return jt(t)?this.clickAnywhere(e,t):Dt(Ke)(t)?this.clickOnVertex(e,t):function(n){return!!n.featureTarget&&!!n.featureTarget.properties&&n.featureTarget.properties.meta===Fe}(t)?this.clickOnFeature(e,t):void 0},J.clickAnywhere=function(e){var t=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach(function(o){return t.doRender(o)})),Je(this),this.stopExtendedInteractions(e)},J.clickOnVertex=function(e,t){this.changeMode(I.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:Ee})},J.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},J.clickOnFeature=function(e,t){var n=this;pt(this),this.stopExtendedInteractions(e);var o=At(t),s=this.getSelectedIds(),r=t.featureTarget.properties.id,a=this.isSelected(r);if(!o&&a&&this.getFeature(r).type!==H)return this.changeMode(I.DIRECT_SELECT,{featureId:r});a&&o?(this.deselect(r),this.updateUIClasses({mouse:ut}),s.length===1&&Je(this)):!a&&o?(this.select(r),this.updateUIClasses({mouse:Ee})):a||o||(s.forEach(function(p){return n.doRender(p)}),this.setSelected(r),this.updateUIClasses({mouse:Ee})),this.doRender(r)},J.onMouseDown=function(e,t){return ze(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&function(n){return!!n.originalEvent&&!!n.originalEvent.shiftKey&&n.originalEvent.button===0}(t)?this.startBoxSelect(e,t):void 0},J.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Bt(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},J.onTouchStart=function(e,t){if(ze(t))return this.startOnActiveFeature(e,t)},J.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},J.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:Ie}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(Qn),this.map.getContainer().appendChild(e.boxSelectElement));var n=Bt(t.originalEvent,this.map.getContainer()),o=Math.min(e.boxSelectStartLocation.x,n.x),s=Math.max(e.boxSelectStartLocation.x,n.x),r=Math.min(e.boxSelectStartLocation.y,n.y),a=Math.max(e.boxSelectStartLocation.y,n.y),p="translate("+o+"px, "+r+"px)";e.boxSelectElement.style.transform=p,e.boxSelectElement.style.WebkitTransform=p,e.boxSelectElement.style.width=s-o+"px",e.boxSelectElement.style.height=a-r+"px"},J.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();var n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};hn(this.getSelected(),n),e.dragMoveLocation=t.lngLat},J.onMouseUp=function(e,t){var n=this;if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){var o=[e.boxSelectStartLocation,Bt(t.originalEvent,this.map.getContainer())],s=this.featuresAt(null,o,"click"),r=this.getUniqueIds(s).filter(function(a){return!n.isSelected(a)});r.length&&(this.select(r),r.forEach(function(a){return n.doRender(a)}),this.updateUIClasses({mouse:Ee}))}this.stopExtendedInteractions(e)},J.toDisplayFeatures=function(e,t,n){t.properties.active=this.isSelected(t.properties.id)?se:ye,n(t),this.fireActionable(),t.properties.active===se&&t.geometry.type!==H&&Rt(t).forEach(n)},J.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},J.onCombineFeatures=function(){var e=this.getSelected();if(!(e.length===0||e.length<2)){for(var t=[],n=[],o=e[0].type.replace("Multi",""),s=0;s<e.length;s++){var r=e[s];if(r.type.replace("Multi","")!==o)return;r.type.includes("Multi")?r.getCoordinates().forEach(function(p){t.push(p)}):t.push(r.getCoordinates()),n.push(r.toGeoJSON())}if(n.length>1){var a=this.newFeature({type:Z,properties:n[0].properties,geometry:{type:"Multi"+o,coordinates:t}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.map.fire(so,{createdFeatures:[a.toGeoJSON()],deletedFeatures:n})}this.fireActionable()}},J.onUncombineFeatures=function(){var e=this,t=this.getSelected();if(t.length!==0){for(var n=[],o=[],s=function(a){var p=t[a];e.isInstanceOf("MultiFeature",p)&&(p.getFeatures().forEach(function(d){e.addFeature(d),d.properties=p.properties,n.push(d.toGeoJSON()),e.select([d.id])}),e.deleteFeature(p.id,{silent:!0}),o.push(p.toGeoJSON()))},r=0;r<t.length;r++)s(r);n.length>1&&this.map.fire(uo,{createdFeatures:n,deletedFeatures:o}),this.fireActionable()}};var gn=Dt(Ke),Fo=Dt(Lt),ve={fireUpdate:function(){this.map.fire(tn,{action:lo,features:this.getSelected().map(function(e){return e.toGeoJSON()})})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);var n=t.featureTarget.properties,o=e.selectedCoordPaths.indexOf(n.coord_path);At(t)||o!==-1?At(t)&&o===-1&&e.selectedCoordPaths.push(n.coord_path):e.selectedCoordPaths=[n.coord_path];var s=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(s)},onMidpoint:function(e,t){this.startDragging(e,t);var n=t.featureTarget.properties;e.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),e.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(e,t){return t.map(function(n){return{feature_id:e,coord_path:n}})},onFeature:function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,n){hn(this.getSelected(),n),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,n){for(var o=e.selectedCoordPaths.map(function(p){return e.feature.getCoordinate(p)}),s=fn(o.map(function(p){return{type:Z,properties:{},geometry:{type:H,coordinates:p}}}),n),r=0;r<o.length;r++){var a=o[r];e.feature.updateCoordinate(e.selectedCoordPaths[r],a[0]+s.lng,a[1]+s.lat)}},clickNoTarget:function(){this.changeMode(I.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(I.SIMPLE_SELECT)},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){var t=e.featureId,n=this.getFeature(t);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===H)throw new TypeError("direct_select mode doesn't handle point features");var o={featureId:t,feature:n,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,o.selectedCoordPaths)),this.setSelected(t),pt(this),this.setActionableState({trash:!0}),o},onStop:function(){Je(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,n){e.featureId===t.properties.id?(t.properties.active=se,n(t),Rt(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(n)):(t.properties.active=ye,n(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort(function(t,n){return n.localeCompare(t,"en",{numeric:!0})}).forEach(function(t){return e.feature.removeCoordinate(t)}),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(I.SIMPLE_SELECT,{}))},onMouseMove:function(e,t){var n=ze(t),o=gn(t),s=e.selectedCoordPaths.length===0;return n&&s||o&&!s?this.updateUIClasses({mouse:Ee}):this.updateUIClasses({mouse:Ft}),this.stopDragging(e),!0},onMouseOut:function(e){return e.dragMoving&&this.fireUpdate(),!0}};ve.onTouchStart=ve.onMouseDown=function(e,t){return gn(t)?this.onVertex(e,t):ze(t)?this.onFeature(e,t):Fo(t)?this.onMidpoint(e,t):void 0},ve.onDrag=function(e,t){if(e.canDragMove===!0){e.dragMoving=!0,t.originalEvent.stopPropagation();var n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat}},ve.onClick=function(e,t){return jt(t)?this.clickNoTarget(e,t):ze(t)?this.clickActiveFeature(e,t):ln(t)?this.clickInactive(e,t):void this.stopDragging(e)},ve.onTap=function(e,t){return jt(t)?this.clickNoTarget(e,t):ze(t)?this.clickActiveFeature(e,t):ln(t)?this.clickInactive(e,t):void 0},ve.onTouchEnd=ve.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var re={};function Jt(e,t){return!!e.lngLat&&e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]}re.onSetup=function(){var e=this.newFeature({type:Z,properties:{},geometry:{type:H,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Ie}),this.activateUIButton(Q.POINT),this.setActionableState({trash:!0}),{point:e}},re.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT)},re.onTap=re.onClick=function(e,t){this.updateUIClasses({mouse:Ee}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Pt,{features:[e.point.toGeoJSON()]}),this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.point.id]})},re.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},re.toDisplayFeatures=function(e,t,n){var o=t.properties.id===e.point.id;if(t.properties.active=o?se:ye,!o)return n(t)},re.onTrash=re.stopDrawingAndRemove,re.onKeyUp=function(e,t){if(Nt(t)||Ut(t))return this.stopDrawingAndRemove(e,t)};var Le={onSetup:function(){var e=this.newFeature({type:Z,properties:{},geometry:{type:he,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),pt(this),this.updateUIClasses({mouse:Ie}),this.activateUIButton(Q.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&Jt(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:Ie}),e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),dt(t)&&this.updateUIClasses({mouse:ut})}};Le.onTap=Le.onClick=function(e,t){return dt(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},Le.onKeyUp=function(e,t){Nt(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT)):Ut(t)&&this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},Le.onStop=function(e){this.updateUIClasses({mouse:Ft}),Je(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate("0."+e.currentVertexPosition),e.polygon.isValid()?this.map.fire(Pt,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT,{},{silent:!0})))},Le.toDisplayFeatures=function(e,t,n){var o=t.properties.id===e.polygon.id;if(t.properties.active=o?se:ye,!o)return n(t);if(t.geometry.coordinates.length!==0){var s=t.geometry.coordinates[0].length;if(!(s<3)){if(t.properties.meta=Fe,n(He(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),s>3){var r=t.geometry.coordinates[0].length-3;n(He(e.polygon.id,t.geometry.coordinates[0][r],"0."+r,!1))}if(s<=4){var a=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:Z,properties:t.properties,geometry:{coordinates:a,type:Re}}),s===3)return}return n(t)}}},Le.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT)};var Oe={onSetup:function(e){var t,n,o=(e=e||{}).featureId,s="forward";if(o){if(!(t=this.getFeature(o)))throw new Error("Could not find a feature with the provided featureId");var r=e.from;if(r&&r.type==="Feature"&&r.geometry&&r.geometry.type==="Point"&&(r=r.geometry),r&&r.type==="Point"&&r.coordinates&&r.coordinates.length===2&&(r=r.coordinates),!r||!Array.isArray(r))throw new Error("Please use the `from` property to indicate which point to continue the line from");var a=t.coordinates.length-1;if(t.coordinates[a][0]===r[0]&&t.coordinates[a][1]===r[1])n=a+1,t.addCoordinate.apply(t,[n].concat(t.coordinates[a]));else{if(t.coordinates[0][0]!==r[0]||t.coordinates[0][1]!==r[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");s="backwards",n=0,t.addCoordinate.apply(t,[n].concat(t.coordinates[0]))}}else t=this.newFeature({type:Z,properties:{},geometry:{type:Re,coordinates:[]}}),n=0,this.addFeature(t);return this.clearSelectedFeatures(),pt(this),this.updateUIClasses({mouse:Ie}),this.activateUIButton(Q.LINE),this.setActionableState({trash:!0}),{line:t,currentVertexPosition:n,direction:s}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&Jt(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&Jt(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:Ie}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.line.id]})},onMouseMove:function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),dt(t)&&this.updateUIClasses({mouse:ut})}};Oe.onTap=Oe.onClick=function(e,t){if(dt(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},Oe.onKeyUp=function(e,t){Ut(t)?this.changeMode(I.SIMPLE_SELECT,{featureIds:[e.line.id]}):Nt(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT))},Oe.onStop=function(e){Je(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(""+e.currentVertexPosition),e.line.isValid()?this.map.fire(Pt,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT,{},{silent:!0})))},Oe.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(I.SIMPLE_SELECT)},Oe.toDisplayFeatures=function(e,t,n){var o=t.properties.id===e.line.id;if(t.properties.active=o?se:ye,!o)return n(t);t.geometry.coordinates.length<2||(t.properties.meta=Fe,n(He(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],""+(e.direction==="forward"?t.geometry.coordinates.length-2:1),!1)),n(t))};var yn={simple_select:J,direct_select:ve,draw_point:re,draw_polygon:Le,draw_line_string:Oe},Po={defaultMode:I.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:yn,controls:{},userProperties:!1},Lo={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Oo={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function mn(e,t){return e.map(function(n){return n.source?n:me(n,{id:n.id+"."+t,source:t==="hot"?Be:qe})})}var To=Tt(function(e,t){var n="[object Arguments]",o="[object Map]",s="[object Object]",r="[object Set]",a=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[n]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[o]=d["[object Number]"]=d[s]=d["[object RegExp]"]=d[r]=d["[object String]"]=d["[object WeakMap]"]=!1;var g=typeof it=="object"&&it&&it.Object===Object&&it,u=typeof self=="object"&&self&&self.Object===Object&&self,f=g||u||Function("return this")(),y=t&&!t.nodeType&&t,v=y&&e&&!e.nodeType&&e,x=v&&v.exports===y,B=x&&g.process,l=function(){try{return B&&B.binding&&B.binding("util")}catch{}}(),m=l&&l.isTypedArray;function O(i,c){for(var h=-1,_=i==null?0:i.length;++h<_;)if(c(i[h],h,i))return!0;return!1}function L(i){var c=-1,h=Array(i.size);return i.forEach(function(_,j){h[++c]=[j,_]}),h}function A(i){var c=-1,h=Array(i.size);return i.forEach(function(_){h[++c]=_}),h}var b,Te,be,E=Array.prototype,ne=Function.prototype,K=Object.prototype,Gt=f["__core-js_shared__"],bn=ne.toString,ie=K.hasOwnProperty,_n=(b=/[^.]+$/.exec(Gt&&Gt.keys&&Gt.keys.IE_PROTO||""))?"Symbol(src)_1."+b:"",Sn=K.toString,Ao=RegExp("^"+bn.call(ie).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xn=x?f.Buffer:void 0,ht=f.Symbol,Cn=f.Uint8Array,Mn=K.propertyIsEnumerable,No=E.splice,ke=ht?ht.toStringTag:void 0,wn=Object.getOwnPropertySymbols,Uo=xn?xn.isBuffer:void 0,Bo=(Te=Object.keys,be=Object,function(i){return Te(be(i))}),Zt=Ge(f,"DataView"),Xe=Ge(f,"Map"),$t=Ge(f,"Promise"),Yt=Ge(f,"Set"),Wt=Ge(f,"WeakMap"),et=Ge(Object,"create"),Ro=Ae(Zt),zo=Ae(Xe),Vo=Ae($t),Jo=Ae(Yt),Go=Ae(Wt),In=ht?ht.prototype:void 0,qt=In?In.valueOf:void 0;function De(i){var c=-1,h=i==null?0:i.length;for(this.clear();++c<h;){var _=i[c];this.set(_[0],_[1])}}function ce(i){var c=-1,h=i==null?0:i.length;for(this.clear();++c<h;){var _=i[c];this.set(_[0],_[1])}}function je(i){var c=-1,h=i==null?0:i.length;for(this.clear();++c<h;){var _=i[c];this.set(_[0],_[1])}}function gt(i){var c=-1,h=i==null?0:i.length;for(this.__data__=new je;++c<h;)this.add(i[c])}function _e(i){var c=this.__data__=new ce(i);this.size=c.size}function Zo(i,c){var h=vt(i),_=!h&&Ko(i),j=!h&&!_&&Kt(i),M=!h&&!_&&!j&&jn(i),U=h||_||j||M,R=U?function(V,ae){for(var le=-1,W=Array(V);++le<V;)W[le]=ae(le);return W}(i.length,String):[],oe=R.length;for(var z in i)!c&&!ie.call(i,z)||U&&(z=="length"||j&&(z=="offset"||z=="parent")||M&&(z=="buffer"||z=="byteLength"||z=="byteOffset")||qo(z,oe))||R.push(z);return R}function yt(i,c){for(var h=i.length;h--;)if(On(i[h][0],c))return h;return-1}function tt(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":ke&&ke in Object(i)?function(c){var h=ie.call(c,ke),_=c[ke];try{c[ke]=void 0;var j=!0}catch{}var M=Sn.call(c);return j&&(h?c[ke]=_:delete c[ke]),M}(i):function(c){return Sn.call(c)}(i)}function En(i){return nt(i)&&tt(i)==n}function Fn(i,c,h,_,j){return i===c||(i==null||c==null||!nt(i)&&!nt(c)?i!=i&&c!=c:function(M,U,R,oe,z,V){var ae=vt(M),le=vt(U),W=ae?"[object Array]":Se(M),de=le?"[object Array]":Se(U),Ze=(W=W==n?s:W)==s,bt=(de=de==n?s:de)==s,$e=W==de;if($e&&Kt(M)){if(!Kt(U))return!1;ae=!0,Ze=!1}if($e&&!Ze)return V||(V=new _e),ae||jn(M)?Pn(M,U,R,oe,z,V):function(k,T,_t,xe,Qt,ee,pe){switch(_t){case"[object DataView]":if(k.byteLength!=T.byteLength||k.byteOffset!=T.byteOffset)return!1;k=k.buffer,T=T.buffer;case"[object ArrayBuffer]":return!(k.byteLength!=T.byteLength||!ee(new Cn(k),new Cn(T)));case"[object Boolean]":case"[object Date]":case"[object Number]":return On(+k,+T);case"[object Error]":return k.name==T.name&&k.message==T.message;case"[object RegExp]":case"[object String]":return k==T+"";case o:var Ce=L;case r:var rt=1&xe;if(Ce||(Ce=A),k.size!=T.size&&!rt)return!1;var St=pe.get(k);if(St)return St==T;xe|=2,pe.set(k,T);var Ye=Pn(Ce(k),Ce(T),xe,Qt,ee,pe);return pe.delete(k),Ye;case"[object Symbol]":if(qt)return qt.call(k)==qt.call(T)}return!1}(M,U,W,R,oe,z,V);if(!(1&R)){var ot=Ze&&ie.call(M,"__wrapped__"),An=bt&&ie.call(U,"__wrapped__");if(ot||An){var Ho=ot?M.value():M,Xo=An?U.value():U;return V||(V=new _e),z(Ho,Xo,R,oe,V)}}return $e?(V||(V=new _e),function(k,T,_t,xe,Qt,ee){var pe=1&_t,Ce=Ln(k),rt=Ce.length,St=Ln(T).length;if(rt!=St&&!pe)return!1;for(var Ye=rt;Ye--;){var Me=Ce[Ye];if(!(pe?Me in T:ie.call(T,Me)))return!1}var Nn=ee.get(k);if(Nn&&ee.get(T))return Nn==T;var xt=!0;ee.set(k,T),ee.set(T,k);for(var Ht=pe;++Ye<rt;){Me=Ce[Ye];var Ct=k[Me],Mt=T[Me];if(xe)var Un=pe?xe(Mt,Ct,Me,T,k,ee):xe(Ct,Mt,Me,k,T,ee);if(!(Un===void 0?Ct===Mt||Qt(Ct,Mt,_t,xe,ee):Un)){xt=!1;break}Ht||(Ht=Me=="constructor")}if(xt&&!Ht){var wt=k.constructor,It=T.constructor;wt==It||!("constructor"in k)||!("constructor"in T)||typeof wt=="function"&&wt instanceof wt&&typeof It=="function"&&It instanceof It||(xt=!1)}return ee.delete(k),ee.delete(T),xt}(M,U,R,oe,z,V)):!1}(i,c,h,_,Fn,j))}function $o(i){return!(!Dn(i)||function(c){return!!_n&&_n in c}(i))&&(Tn(i)?Ao:a).test(Ae(i))}function Yo(i){if(h=(c=i)&&c.constructor,_=typeof h=="function"&&h.prototype||K,c!==_)return Bo(i);var c,h,_,j=[];for(var M in Object(i))ie.call(i,M)&&M!="constructor"&&j.push(M);return j}function Pn(i,c,h,_,j,M){var U=1&h,R=i.length,oe=c.length;if(R!=oe&&!(U&&oe>R))return!1;var z=M.get(i);if(z&&M.get(c))return z==c;var V=-1,ae=!0,le=2&h?new gt:void 0;for(M.set(i,c),M.set(c,i);++V<R;){var W=i[V],de=c[V];if(_)var Ze=U?_(de,W,V,c,i,M):_(W,de,V,i,c,M);if(Ze!==void 0){if(Ze)continue;ae=!1;break}if(le){if(!O(c,function(bt,$e){if(ot=$e,!le.has(ot)&&(W===bt||j(W,bt,h,_,M)))return le.push($e);var ot})){ae=!1;break}}else if(W!==de&&!j(W,de,h,_,M)){ae=!1;break}}return M.delete(i),M.delete(c),ae}function Ln(i){return function(c,h,_){var j=h(c);return vt(c)?j:function(M,U){for(var R=-1,oe=U.length,z=M.length;++R<oe;)M[z+R]=U[R];return M}(j,_(c))}(i,Qo,Wo)}function mt(i,c){var h,_,j=i.__data__;return((_=typeof(h=c))=="string"||_=="number"||_=="symbol"||_=="boolean"?h!=="__proto__":h===null)?j[typeof c=="string"?"string":"hash"]:j.map}function Ge(i,c){var h=function(_,j){return _==null?void 0:_[j]}(i,c);return $o(h)?h:void 0}De.prototype.clear=function(){this.__data__=et?et(null):{},this.size=0},De.prototype.delete=function(i){var c=this.has(i)&&delete this.__data__[i];return this.size-=c?1:0,c},De.prototype.get=function(i){var c=this.__data__;if(et){var h=c[i];return h==="__lodash_hash_undefined__"?void 0:h}return ie.call(c,i)?c[i]:void 0},De.prototype.has=function(i){var c=this.__data__;return et?c[i]!==void 0:ie.call(c,i)},De.prototype.set=function(i,c){var h=this.__data__;return this.size+=this.has(i)?0:1,h[i]=et&&c===void 0?"__lodash_hash_undefined__":c,this},ce.prototype.clear=function(){this.__data__=[],this.size=0},ce.prototype.delete=function(i){var c=this.__data__,h=yt(c,i);return!(h<0)&&(h==c.length-1?c.pop():No.call(c,h,1),--this.size,!0)},ce.prototype.get=function(i){var c=this.__data__,h=yt(c,i);return h<0?void 0:c[h][1]},ce.prototype.has=function(i){return yt(this.__data__,i)>-1},ce.prototype.set=function(i,c){var h=this.__data__,_=yt(h,i);return _<0?(++this.size,h.push([i,c])):h[_][1]=c,this},je.prototype.clear=function(){this.size=0,this.__data__={hash:new De,map:new(Xe||ce),string:new De}},je.prototype.delete=function(i){var c=mt(this,i).delete(i);return this.size-=c?1:0,c},je.prototype.get=function(i){return mt(this,i).get(i)},je.prototype.has=function(i){return mt(this,i).has(i)},je.prototype.set=function(i,c){var h=mt(this,i),_=h.size;return h.set(i,c),this.size+=h.size==_?0:1,this},gt.prototype.add=gt.prototype.push=function(i){return this.__data__.set(i,"__lodash_hash_undefined__"),this},gt.prototype.has=function(i){return this.__data__.has(i)},_e.prototype.clear=function(){this.__data__=new ce,this.size=0},_e.prototype.delete=function(i){var c=this.__data__,h=c.delete(i);return this.size=c.size,h},_e.prototype.get=function(i){return this.__data__.get(i)},_e.prototype.has=function(i){return this.__data__.has(i)},_e.prototype.set=function(i,c){var h=this.__data__;if(h instanceof ce){var _=h.__data__;if(!Xe||_.length<199)return _.push([i,c]),this.size=++h.size,this;h=this.__data__=new je(_)}return h.set(i,c),this.size=h.size,this};var Wo=wn?function(i){return i==null?[]:(i=Object(i),function(c,h){for(var _=-1,j=c==null?0:c.length,M=0,U=[];++_<j;){var R=c[_];h(R,_,c)&&(U[M++]=R)}return U}(wn(i),function(c){return Mn.call(i,c)}))}:function(){return[]},Se=tt;function qo(i,c){return!!(c=c??9007199254740991)&&(typeof i=="number"||p.test(i))&&i>-1&&i%1==0&&i<c}function Ae(i){if(i!=null){try{return bn.call(i)}catch{}try{return i+""}catch{}}return""}function On(i,c){return i===c||i!=i&&c!=c}(Zt&&Se(new Zt(new ArrayBuffer(1)))!="[object DataView]"||Xe&&Se(new Xe)!=o||$t&&Se($t.resolve())!="[object Promise]"||Yt&&Se(new Yt)!=r||Wt&&Se(new Wt)!="[object WeakMap]")&&(Se=function(i){var c=tt(i),h=c==s?i.constructor:void 0,_=h?Ae(h):"";if(_)switch(_){case Ro:return"[object DataView]";case zo:return o;case Vo:return"[object Promise]";case Jo:return r;case Go:return"[object WeakMap]"}return c});var Ko=En(function(){return arguments}())?En:function(i){return nt(i)&&ie.call(i,"callee")&&!Mn.call(i,"callee")},vt=Array.isArray,Kt=Uo||function(){return!1};function Tn(i){if(!Dn(i))return!1;var c=tt(i);return c=="[object Function]"||c=="[object GeneratorFunction]"||c=="[object AsyncFunction]"||c=="[object Proxy]"}function kn(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=9007199254740991}function Dn(i){var c=typeof i;return i!=null&&(c=="object"||c=="function")}function nt(i){return i!=null&&typeof i=="object"}var jn=m?function(i){return function(c){return i(c)}}(m):function(i){return nt(i)&&kn(i.length)&&!!d[tt(i)]};function Qo(i){return(c=i)!=null&&kn(c.length)&&!Tn(c)?Zo(i):Yo(i);var c}e.exports=function(i,c){return Fn(i,c)}}),ko={Polygon:X,LineString:ue,Point:Pe,MultiPolygon:q,MultiLineString:q,MultiPoint:q};function Do(e,t){return t.modes=I,t.getFeatureIdsAt=function(n){return Qe.click({point:n},null,e).map(function(o){return o.properties.id})},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:ge,features:e.store.getSelectedIds().map(function(n){return e.store.get(n)}).map(function(n){return n.toGeoJSON()})}},t.getSelectedPoints=function(){return{type:ge,features:e.store.getSelectedCoordinates().map(function(n){return{type:Z,properties:{},geometry:{type:H,coordinates:n.coordinates}}})}},t.set=function(n){if(n.type===void 0||n.type!==ge||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");var o=e.store.createRenderBatch(),s=e.store.getAllIds().slice(),r=t.add(n),a=new te(r);return(s=s.filter(function(p){return!a.has(p)})).length&&t.delete(s),o(),r},t.add=function(n){var o=JSON.parse(JSON.stringify(dn(n))).features.map(function(s){if(s.id=s.id||kt(),s.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(s.id)===void 0||e.store.get(s.id).type!==s.geometry.type){var r=ko[s.geometry.type];if(r===void 0)throw new Error("Invalid geometry type: "+s.geometry.type+".");var a=new r(e,s);e.store.add(a)}else{var p=e.store.get(s.id);p.properties=s.properties,To(p.getCoordinates(),s.geometry.coordinates)||p.incomingCoords(s.geometry.coordinates)}return s.id});return e.store.render(),o},t.get=function(n){var o=e.store.get(n);if(o)return o.toGeoJSON()},t.getAll=function(){return{type:ge,features:e.store.getAll().map(function(n){return n.toGeoJSON()})}},t.delete=function(n){return e.store.delete(n,{silent:!0}),t.getMode()!==I.DIRECT_SELECT||e.store.getSelectedIds().length?e.store.render():e.events.changeMode(I.SIMPLE_SELECT,void 0,{silent:!0}),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===I.DIRECT_SELECT?e.events.changeMode(I.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(n,o){return o===void 0&&(o={}),n===I.SIMPLE_SELECT&&t.getMode()===I.SIMPLE_SELECT?(s=o.featureIds||[],r=e.store.getSelectedIds(),s.length===r.length&&JSON.stringify(s.map(function(a){return a}).sort())===JSON.stringify(r.map(function(a){return a}).sort())||(e.store.setSelected(o.featureIds,{silent:!0}),e.store.render()),t):(n===I.DIRECT_SELECT&&t.getMode()===I.DIRECT_SELECT&&o.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(n,o,{silent:!0}),t);var s,r},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(n,o,s){return e.store.setFeatureProperty(n,o,s),t},t}var jo=function(e,t){var n={options:e=function(s){s===void 0&&(s={});var r=me(s);return s.controls||(r.controls={}),s.displayControlsDefault===!1?r.controls=me(Oo,s.controls):r.controls=me(Lo,s.controls),(r=me(Po,r)).styles=mn(r.styles,"cold").concat(mn(r.styles,"hot")),r}(e)};t=Do(n,t),n.api=t;var o=So(n);return t.onAdd=o.onAdd,t.onRemove=o.onRemove,t.types=Q,t.options=e,t};function vn(e){jo(e,this)}return vn.modes=yn,vn})})(Bn);var Et=Bn.exports;const We="select_feature",st=`${We}_highlight`,tr={highlightColor:"#222"},Ue={};Ue.onSetup=function(S){const{selectHighlightColor:w,onSelect:F,onCancel:N}=S,P={};P.hoveredFeatureID=null,P.selectedFeatureID=null,P.onSelect=F,P.onCancel=N,P.api=this._ctx.api;const{selectHighlightColor:G=tr.highlightColor}=this._ctx.options;return P.options={selectHighlightColor:w||G},P};Ue.onMouseMove=function(S,w){const{api:F}=S,{featureTarget:N}=w;if(N){this.updateUIClasses({mouse:Et.Constants.cursors.POINTER});const P=N.properties.id;S.hoveredFeatureID!==null&&S.hoveredFeatureID!==P&&F.setFeatureProperty(S.hoveredFeatureID,st,void 0),S.hoveredFeatureID=P,F.setFeatureProperty(S.hoveredFeatureID,st,S.options.selectHighlightColor)}else S.hoveredFeatureID&&F.setFeatureProperty(S.hoveredFeatureID,st,void 0),S.hoveredFeatureID=null};Ue.onClick=function(S,w){S.selectedFeatureID=S.hoveredFeatureID,this.onStop(S,w)};Ue.toDisplayFeatures=function(S,w,F){F(w)};Ue.onKeyUp=function(S,w){Et.CommonSelectors.isEscapeKey(w)&&typeof S.onCancel=="function"&&setTimeout(S.onCancel,0)};Ue.onStop=function(S){this.updateUIClasses({mouse:Et.Constants.cursors.NONE}),Et.lib.doubleClickZoom.enable(this),this.activateUIButton(),S.selectedFeatureID?(typeof S.onSelect=="function"?setTimeout(S.onSelect.bind(null,S.selectedFeatureID),0):this.map.fire("draw.select_mode.select",{featureID:S.selectedFeatureID}),S.selectedFeatureID=null):typeof S.onCancel=="function"&&setTimeout(S.onCancel,0),S.hoveredFeatureID&&(this._ctx.api.setFeatureProperty(S.hoveredFeatureID,st,void 0),S.hoveredFeatureID=null)};const fe=`user_${st}`,nr=S=>S.concat([{id:`${We}-fill`,type:"fill",filter:["all",["==","$type","Polygon"],["has",fe]],paint:{"fill-color":["get",fe],"fill-outline-color":["get",fe],"fill-opacity":.2}},{id:`${We}-stroke`,type:"line",filter:["all",["==","$type","Polygon"],["has",fe]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["get",fe],"line-dasharray":[.2,2],"line-width":2}},{id:`${We}-line`,type:"line",filter:["all",["==","$type","LineString"],["has",fe]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["get",fe],"line-dasharray":[.2,2],"line-width":2}},{id:`${We}-point`,type:"circle",filter:["all",["==","$type","Point"],["has",fe]],paint:{"circle-color":["get",fe],"circle-radius":3}}]);function or(S){return{...S,[We]:Ue}}let at,Ne,Rn;const rr=()=>{try{Ne==null||Ne.changeMode("select_feature",{onSelect(S){alert(`Selected Feature ID: ${S}`)}})}catch(S){alert(S.message),console.error(S)}};class ir{constructor(w){let F=this;F.draw=w.draw,F.buttons=w.buttons||[],F.onAddOrig=w.draw.onAdd,F.onRemoveOrig=w.draw.onRemove}onAdd(w){let F=this;return F.map=w,F.elContainer=F.onAddOrig(w),F.buttons.forEach(N=>{F.addButton(N)}),F.elContainer}onRemove(w){let F=this;F.buttons.forEach(N=>{F.removeButton(N)}),F.onRemoveOrig(w)}addButton(w){let F=this;var N=document.createElement("button");N.className="mapbox-gl-draw_ctrl-draw-btn",w.classes instanceof Array&&w.classes.forEach(P=>{N.classList.add(P)}),N.addEventListener(w.on,w.action),F.elContainer.appendChild(N),w.elButton=N}removeButton(w){w.elButton.removeEventListener(w.on,w.action),w.elButton.remove()}}mapboxgl.getRTLTextPluginStatus()==="unavailable"&&mapboxgl.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",S=>{S&&console.error(S)},!0);at=new mapboxgl.Map({container:"map",style:"https://map.ir/vector/styles/main/mapir-xyz-light-style.json",center:[51.3857,35.6102],zoom:7.78,pitch:0,interactive:!0,hash:!0,attributionControl:!0,customAttribution:" Map  Openstreetmap",transformRequest:S=>({url:S,headers:{"x-api-key":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImRiZWU0YWU4OTk4OTA3MmQ3OTFmMjQ4ZDE5N2VhZTgwZWU2NTUyYjhlYjczOWI2NDdlY2YyYzIzNWRiYThiMzIzOTM5MDkzZDM0NTY2MmU3In0.eyJhdWQiOiI5NDMyIiwianRpIjoiZGJlZTRhZTg5OTg5MDcyZDc5MWYyNDhkMTk3ZWFlODBlZTY1NTJiOGViNzM5YjY0N2VjZjJjMjM1ZGJhOGIzMjM5MzkwOTNkMzQ1NjYyZTciLCJpYXQiOjE1OTA4MjU0NzIsIm5iZiI6MTU5MDgyNTQ3MiwiZXhwIjoxNTkzNDE3NDcyLCJzdWIiOiIiLCJzY29wZXMiOlsiYmFzaWMiXX0.M_z4xJlJRuYrh8RFe9UrW89Y_XBzpPth4yk3hlT-goBm8o3x8DGCrSqgskFfmJTUD2wC2qSoVZzQKB67sm-swtD5fkxZO7C0lBCMAU92IYZwCdYehIOtZbP5L1Lfg3C6pxd0r7gQOdzcAZj9TStnKBQPK3jSvzkiHIQhb6I0sViOS_8JceSNs9ZlVelQ3gs77xM2ksWDM6vmqIndzsS-5hUd-9qdRDTLHnhdbS4_UBwNDza47Iqd5vZkBgmQ_oDZ7dVyBuMHiQFg28V6zhtsf3fijP0UhePCj4GM89g3tzYBOmuapVBobbX395FWpnNC3bYg7zDaVHcllSUYDjGc1A","Mapir-SDK":"reactjs"}})});Ne=new MapboxDraw({modes:{...or(MapboxDraw.modes)},styles:[...nr(er)],userProperties:!0,selectHighlightColor:"red"});window.draw=Ne;Rn=new ir({draw:Ne,buttons:[{on:"click",action:rr,classes:["select-icon"]}]});at.once("load",()=>{at.resize(),at.addControl(Rn,"top-right"),Ne.set({type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[[[51.03172414839912,35.920869678862005],[51.03172414839912,35.62049410212656],[51.461567534481134,35.62049410212656],[51.461567534481134,35.920869678862005],[51.03172414839912,35.920869678862005]]],type:"Polygon"}},{type:"Feature",properties:{},geometry:{coordinates:[[51.6404618916944,35.57806814108352],[51.82929482430853,35.860482623322696]],type:"LineString"}},{type:"Feature",properties:{},geometry:{coordinates:[51.40193608207707,35.45267939803206],type:"Point"}}]}),at.on("draw.update",function(S){console.log(" ~ file: index.js ~ line 158 ~ e",S)})});
